<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Isabella ‚ú® 15 A√±os</title>
  <style>
    :root{
      --bg1:#fff7fb;
      --bg2:#f2fbff;
      --card:#ffffffcc;
      --ink:#2b2b2b;
      --muted:#6b6b6b;
      --pink:#ff5fa2;
      --violet:#8a5cff;
      --mint:#35d6c2;
      --shadow: 0 18px 50px rgba(0,0,0,.12);
      --radius: 22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink)}
    body{
      background:
        radial-gradient(1200px 800px at 20% 0%, #ffd7ea 0%, transparent 60%),
        radial-gradient(1000px 700px at 100% 20%, #d6f4ff 0%, transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }
    .wrap{ min-height:100%; display:flex; align-items:center; justify-content:center; padding:20px 16px 28px; }
    .app{ width:min(980px, 100%); display:grid; grid-template-columns: 1.05fr .95fr; gap:16px; }
    @media (max-width: 860px){ .app{grid-template-columns:1fr; gap:14px;} }

    .card{
      background:var(--card);
      border:1px solid rgba(255,255,255,.55);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding:18px;
      position:relative;
      overflow:hidden;
    }

    .titleRow{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:10px; }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background:linear-gradient(90deg, rgba(255,95,162,.18), rgba(138,92,255,.16));
      border:1px solid rgba(255,95,162,.22);
      font-weight:800;
    }
    .spark{width:12px; height:12px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, #ffd6f0 35%, #ff5fa2 75%, #8a5cff 100%);
      box-shadow:0 0 18px rgba(255,95,162,.55);
      animation: pulse 1.5s ease-in-out infinite;
    }
    @keyframes pulse{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.25)} }

    h1{ margin:0; font-size: clamp(22px, 4vw, 34px); letter-spacing:.2px; }
    .sub{ margin:6px 0 0; color:var(--muted); line-height:1.35; font-size: 14.5px; }

    .progress{ margin-top:14px; display:flex; align-items:center; gap:10px; }
    .bar{ flex:1; height:10px; background:rgba(0,0,0,.07); border-radius:999px; overflow:hidden; }
    .bar > i{ display:block; height:100%; width:0%; background:linear-gradient(90deg, var(--pink), var(--violet), var(--mint)); border-radius:999px; transition: width .35s ease; }
    .pct{ min-width:64px; text-align:right; font-weight:900; color:rgba(43,43,43,.8); }

    .msgBox{ margin-top:14px; padding:16px; border-radius:18px; background:rgba(255,255,255,.85); border:1px dashed rgba(255,95,162,.35); position:relative; }
    .msgBox .label{ display:flex; align-items:center; gap:8px; font-weight:950; margin-bottom:10px; color:rgba(43,43,43,.9); }
    .msgBox .label .heart{ width:14px; height:14px; transform: rotate(45deg); background:linear-gradient(135deg, var(--pink), var(--violet)); border-radius:4px; position:relative; }
    .msgBox .label .heart:before,
    .msgBox .label .heart:after{ content:""; position:absolute; width:14px; height:14px; background:inherit; border-radius:50%; top:-7px; left:0; }
    .msgBox .label .heart:after{ left:-7px; top:0; }

    .message{ min-height:92px; font-size: 16px; line-height: 1.5; margin:0; word-break: break-word; }
    .message .chip{
      display:inline-block;
      margin:4px 6px 0 0;
      padding:6px 10px;
      border-radius:999px;
      background:linear-gradient(90deg, rgba(255,95,162,.16), rgba(138,92,255,.12));
      border:1px solid rgba(255,95,162,.22);
      animation: pop .26s ease-out;
      font-weight:800;
    }
    @keyframes pop{ from{ transform: scale(.9); opacity:.35 } to{ transform: scale(1); opacity:1 } }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:12px; }
    @media (max-width: 520px){ .grid{grid-template-columns:1fr;} }

    button{
      appearance:none;
      border:0;
      width:100%;
      text-align:left;
      padding:12px 12px;
      border-radius:16px;
      background:rgba(255,255,255,.86);
      border:1px solid rgba(0,0,0,.06);
      box-shadow: 0 10px 22px rgba(0,0,0,.06);
      color:var(--ink);
      font-weight:900;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
      position:relative;
      overflow:hidden;
    }
    button:active{ transform: translateY(1px) scale(.99); }
    button:hover{ box-shadow: 0 14px 28px rgba(0,0,0,.08); }
    button[disabled]{ opacity:.45; cursor:not-allowed; }

    .kemoji{font-size:18px; margin-right:8px}
    .hint{ margin-top:10px; font-size: 13px; color: var(--muted); }

    .scene{ height:100%; min-height: 420px; display:flex; flex-direction:column; justify-content:space-between; position:relative; }
    .big{ display:grid; gap:10px; align-content:start; }
    .poster{
      border-radius: 22px;
      padding:16px;
      background:linear-gradient(135deg, rgba(255,95,162,.20), rgba(138,92,255,.14), rgba(53,214,194,.12));
      border:1px solid rgba(255,255,255,.55);
      box-shadow: 0 18px 50px rgba(0,0,0,.10);
      position:relative;
      overflow:hidden;
    }
    .poster h2{ margin:0; font-size: clamp(20px, 3.5vw, 28px); letter-spacing:.2px; }
    .poster p{ margin:8px 0 0; color:rgba(43,43,43,.75); line-height:1.4; font-weight:750; }
    .ctaRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    .cta{
      flex:1;
      min-width: 140px;
      text-align:center;
      background:linear-gradient(90deg, rgba(255,95,162,.22), rgba(138,92,255,.20));
      border:1px solid rgba(255,95,162,.25);
      font-weight:950;
    }
    .cta.secondary{ background:rgba(255,255,255,.78); border:1px solid rgba(0,0,0,.06); }

    .mascotRow{ display:flex; gap:12px; align-items:flex-end; justify-content:center; padding-top:6px; flex-wrap:wrap; }
    .mascot{
      width: 120px; height:120px;
      border-radius: 30px;
      background:rgba(255,255,255,.85);
      border:1px solid rgba(0,0,0,.06);
      box-shadow: 0 14px 34px rgba(0,0,0,.10);
      position:relative;
      overflow:hidden;
      animation: bob 2.2s ease-in-out infinite;
    }
    .mascot:nth-child(2){ animation-delay: .35s }
    .mascot:nth-child(3){ animation-delay: .7s }
    .mascot:nth-child(4){ animation-delay: 1.05s }
    @keyframes bob{ 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-8px) } }
    .face{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size: 54px; filter: drop-shadow(0 12px 22px rgba(0,0,0,.12)); }
    .nameTag{
      position:absolute; left:10px; right:10px; bottom:10px;
      text-align:center;
      font-weight:950;
      padding:6px 10px;
      border-radius:999px;
      background:linear-gradient(90deg, rgba(255,95,162,.18), rgba(138,92,255,.14));
      border:1px solid rgba(255,95,162,.20);
      font-size: 13px;
    }

    .floatLayer{ position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index: 30; }
    .floatHeart{
      position:absolute;
      width:14px; height:14px;
      transform: rotate(45deg);
      background:linear-gradient(135deg, var(--pink), var(--violet));
      border-radius:4px;
      opacity:.9;
      filter: drop-shadow(0 10px 16px rgba(255,95,162,.25));
      animation: floatUp linear forwards;
    }
    .floatHeart:before, .floatHeart:after{ content:""; position:absolute; width:14px; height:14px; background:inherit; border-radius:50%; top:-7px; left:0; }
    .floatHeart:after{ left:-7px; top:0; }
    @keyframes floatUp{
      from{ transform: translateY(0) rotate(45deg) scale(.95); opacity:.0 }
      10%{ opacity:.9 }
      to{ transform: translateY(-120vh) rotate(45deg) scale(1.25); opacity:0 }
    }

    .overlay{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      background: rgba(20, 12, 22, .45);
      z-index: 40;
      padding: 18px;
    }
    .overlay.show{ display:flex; }
    .finalCard{
      width:min(720px, 100%);
      background: rgba(255,255,255,.92);
      border:1px solid rgba(255,255,255,.55);
      border-radius: 26px;
      box-shadow: 0 24px 80px rgba(0,0,0,.22);
      overflow:hidden;
      position:relative;
    }
    .finalTop{ padding:18px 18px 10px; background: linear-gradient(135deg, rgba(255,95,162,.22), rgba(138,92,255,.18), rgba(53,214,194,.14)); }
    .finalTop h3{ margin:0; font-size: clamp(20px, 4vw, 30px); }
    .finalBody{ padding:16px 18px 18px; }
    .finalMsg{ margin:0; font-size: 18px; line-height: 1.55; font-weight: 800; }
    .finalBtns{ display:flex; gap:10px; flex-wrap:wrap; margin-top:14px; }
    .finalBtns button{ text-align:center; font-weight:980; }
    canvas#confetti{ position:absolute; inset:0; width:100%; height:100%; pointer-events:none; }

    .footer{ text-align:center; font-size:12.5px; color:rgba(43,43,43,.55); margin-top:10px; }
  </style>
</head>

<body>
  <div class="floatLayer" id="floatLayer" aria-hidden="true"></div>

  <div class="wrap">
    <div class="app">

      <section class="card" id="gameCard">
        <div class="titleRow">
          <div>
            <h1>üíñ Juego Kawaii para Isabella</h1>
            <p class="sub">Princesita: toc√° frases para armar un mensaje de amor. Cuando completes el coraz√≥n‚Ä¶ ¬°hay sorpresa! ‚ú®</p>
            <div id="jsStatus" style="margin-top:10px;padding:10px 12px;border-radius:14px;background:rgba(255,95,162,.10);border:1px solid rgba(255,95,162,.20);font-weight:900;color:rgba(43,43,43,.85)">‚ö†Ô∏è Si ves este aviso, el navegador no est√° ejecutando JavaScript. Abr√≠ este archivo en <b>Chrome</b> (Android) o <b>Safari</b> (iPhone) y no en ‚ÄúVista previa‚Äù de Drive/Archivos.</div>
          </div>
          <div class="badge"><span class="spark"></span> 15 A√±os</div>
        </div>

        <div class="progress" aria-label="Progreso">
          <div class="bar"><i id="barFill"></i></div>
          <div class="pct" id="pct">0%</div>
        </div>

        <div class="msgBox">
          <div class="label"><span class="heart"></span> Tu mensaje se arma as√≠:</div>
          <p class="message" id="message"></p>
          <div class="hint" id="hint">Tip: toc√° 6‚Äì8 frases para que quede perfecto üòä</div>
        </div>

        <div class="grid" id="buttons"></div>

        <div class="hint">Funciona sin internet. Ideal para abrirlo en el hotel desde el tel√©fono üè®</div>

        <div class="footer">Hecho con üíó para Isabella (mi princesita).</div>
      </section>

      <aside class="card scene">
        <div class="big">
          <div class="poster">
            <h2>üå∏ Isabella, mi princesita üå∏</h2>
            <p>
              Este jueguito es un regalo chiquito, pero con un mensaje gigante.
              Porque tu mam√° y yo trabajamos mucho para traerte de Venezuela a Argentina,
              para una vida llena de oportunidades, arte y sue√±os.
            </p>
            <div class="ctaRow">
              <button class="cta" id="btnFinal">‚ú® Ver final (cuando est√© completo)</button>
              <button class="cta secondary" id="btnReset">üîÑ Reiniciar</button>
            </div>
          </div>

          <div class="mascotRow" aria-hidden="true">
            <div class="mascot"><div class="face">üëë</div><div class="nameTag">Princesita</div></div>
            <div class="mascot"><div class="face">üé®</div><div class="nameTag">Arte</div></div>
            <div class="mascot"><div class="face">üíÉ</div><div class="nameTag">Baile</div></div>
            <div class="mascot"><div class="face">üîé</div><div class="nameTag">Curiosidad</div></div>
          </div>
        </div>

        <div class="footer">Secretito: prob√° tocar ‚ÄúZeus‚Äù y despu√©s ‚ÄúTalasofobia‚Äù üòâ</div>
      </aside>

    </div>
  </div>

  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-label="Mensaje final">
    <div class="finalCard">
      <canvas id="confetti"></canvas>
      <div class="finalTop">
        <h3>üéâ ¬°Feliz cumplea√±os, Isabella! üéâ</h3>
      </div>
      <div class="finalBody">
        <p class="finalMsg" id="finalMsg"></p>
        <div class="finalBtns">
          <button id="btnCopy">üìã Copiar mensaje</button>
          <button id="btnClose" class="cta secondary">Cerrar</button>
          <button id="btnReset2" class="cta secondary">Reiniciar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Frases kawaii + detalles personales
    const phrases = [
      { emoji:"üëë", text:"Mi princesita" },
      { emoji:"‚ú®", text:"Eres mi orgullo" },
      { emoji:"üå∑", text:"Tu sonrisa me ilumina" },
      { emoji:"ü´∂", text:"Gracias por elegirme" },
      { emoji:"üåü", text:"Eres una luz en mi vida" },
      { emoji:"üß∏", text:"Siempre voy a cuidarte" },
      { emoji:"üéÄ", text:"Eres dulce y valiente" },
      { emoji:"üíé", text:"Tu coraz√≥n es enorme" },
      { emoji:"üé®", text:"Amas el arte y lo llevas por dentro" },
      { emoji:"üíÉ", text:"Cuando bailas, el mundo se vuelve m√°s bonito" },
      { emoji:"üîé", text:"Te encanta investigar cosas raras y geniales" },
      { emoji:"‚ö°", text:"Zeus estar√≠a orgulloso de tu curiosidad" },
      { emoji:"üåä", text:"Incluso la talasofobia no te detiene" },
      { emoji:"üáªüá™", text:"De Venezuela trajiste tu fuerza" },
      { emoji:"üá¶üá∑", text:"En Argentina est√°s construyendo tus sue√±os" },
      { emoji:"ü§ç", text:"Tu mam√° y yo trabajamos mucho por tu felicidad" },
      { emoji:"üß°", text:"Desde que ten√≠as 4 a√±os" },
      { emoji:"üß≠", text:"Caminamos juntos y no nos separamos" },
      { emoji:"üåà", text:"Siempre quiero verte feliz" },
      { emoji:"ü•π", text:"Te amo con todo mi coraz√≥n" },
    ];

    const FINAL_LINE = "Feliz cumplea√±os, hija hermosa. Te amo y espero seguir siendo tu padre para toda la vida.";

    const picked = [];
    const targetMin = 7;
    const targetMax = 9;

    const buttonsWrap = document.getElementById("buttons");
    const messageEl = document.getElementById("message");
    const barFill = document.getElementById("barFill");
    const pctEl = document.getElementById("pct");
    const hintEl = document.getElementById("hint");
    const overlay = document.getElementById("overlay");
    const finalMsgEl = document.getElementById("finalMsg");
    const floatLayer = document.getElementById("floatLayer");
    const btnFinal = document.getElementById("btnFinal");
    const btnReset = document.getElementById("btnReset");
    const btnReset2 = document.getElementById("btnReset2");
    const btnClose = document.getElementById("btnClose");
    const btnCopy = document.getElementById("btnCopy");

    function shuffle(arr){
      const a = arr.slice();
      for (let i=a.length-1; i>0; i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    function renderButtons(){
      buttonsWrap.innerHTML = "";
      const list = shuffle(phrases);
      list.forEach((p) => {
        const b = document.createElement("button");
        b.innerHTML = `<span class="kemoji">${p.emoji}</span>${p.text}`;
        b.addEventListener("click", () => pickPhrase(p, b));
        buttonsWrap.appendChild(b);
      });
    }

    function pickPhrase(p, btn){
      if (picked.length >= targetMax) return;
      picked.push(p);
      btn.disabled = true;

      const chip = document.createElement("span");
      chip.className = "chip";
      chip.textContent = `${p.emoji} ${p.text}`;
      messageEl.appendChild(chip);

      burstHearts(8);
      updateProgress();

      // Secret combo: Zeus + Talasofobia => extra hearts
      const texts = picked.map(x => x.text.toLowerCase());
      if (texts.some(t=>t.includes("zeus")) && texts.some(t=>t.includes("talaso"))){
        burstHearts(18);
        hintEl.textContent = "¬°Combo secreto activado! ‚ö°üåä (Isabella investigadora mode) ‚ú®";
      }

      if (picked.length >= targetMin){
        btnFinal.disabled = false;
        if (!hintEl.textContent.includes("Combo secreto"))
          hintEl.textContent = "¬°Ya casi! Pod√©s seguir agregando‚Ä¶ o ver el final ‚ú®";
      }

      if (picked.length === targetMax){
        btnFinal.disabled = false;
        if (!hintEl.textContent.includes("Combo secreto"))
          hintEl.textContent = "¬°Perfecto! Ahora s√≠: toc√° ‚ÄúVer final‚Äù ‚ú®";
      }
    }

    function updateProgress(){
      const pct = Math.round((picked.length / targetMax) * 100);
      barFill.style.width = `${pct}%`;
      pctEl.textContent = `${pct}%`;
    }

    function resetGame(){
      picked.length = 0;
      messageEl.innerHTML = "";
      barFill.style.width = "0%";
      pctEl.textContent = "0%";
      hintEl.textContent = "Tip: toc√° 6‚Äì8 frases para que quede perfecto üòä";
      btnFinal.disabled = true;

    // Se√±al de que JS est√° corriendo
    const jsStatus = document.getElementById('jsStatus');
    if (jsStatus) jsStatus.style.display = 'none';

    renderButtons();
      burstHearts(12);
    }

    function burstHearts(n=6){
      const w = window.innerWidth;
      for (let i=0;i<n;i++){
        const h = document.createElement("div");
        h.className = "floatHeart";
        const x = Math.random()*w;
        const dur = 1700 + Math.random()*1600;
        h.style.left = `${x}px`;
        h.style.bottom = `-20px`;
        h.style.animationDuration = `${dur}ms`;
        h.style.opacity = "0";
        floatLayer.appendChild(h);
        setTimeout(()=> h.remove(), dur+50);
      }
    }

    function buildFinalMessage(){
      const parts = picked.map(p => p.text);
      const hasSince4 = parts.some(t => t.toLowerCase().includes("4"));
      const hasTogether = parts.some(t => t.toLowerCase().includes("no nos separamos") || t.toLowerCase().includes("caminamos juntos"));
      const hasVnz = parts.some(t => t.toLowerCase().includes("venezuela"));
      const hasArg = parts.some(t => t.toLowerCase().includes("argentina"));
      const intro = "Isabella, mi princesita‚Ä¶ ";

      const core = parts.length ? parts.join(". ") + "." : "Quer√≠a decirte algo con todo mi coraz√≥n.";

      const bridge = [
        hasVnz && hasArg ? "" : " Tu mam√° y yo trabajamos much√≠simo para traerte de Venezuela a Argentina y darte una vida mejor.",
        hasSince4 ? "" : " Desde que ten√≠as 4 a√±os,",
        hasTogether ? "" : " caminamos juntos y no nos separamos."
      ].join(" ").replace(/\s+/g," ").trim();

      return `${intro}${core} ${bridge} ${FINAL_LINE}`.replace(/\s+/g," ").trim();
    }

    function showFinal(){
      if (picked.length < targetMin){
        burstHearts(10);
        hintEl.textContent = "Te falta un poquito üíó Toc√° algunas frases m√°s antes del final ‚ú®";
        return;
      }
      finalMsgEl.textContent = buildFinalMessage();
      overlay.classList.add("show");
      startConfetti();
    }

    function closeFinal(){
      overlay.classList.remove("show");
      stopConfetti();
    }

    async function copyFinal(){
      try{
        await navigator.clipboard.writeText(finalMsgEl.textContent);
        btnCopy.textContent = "‚úÖ ¬°Copiado!";
        setTimeout(()=> btnCopy.textContent="üìã Copiar mensaje", 1400);
      }catch(e){
        btnCopy.textContent = "‚ö†Ô∏è No se pudo copiar";
        setTimeout(()=> btnCopy.textContent="üìã Copiar mensaje", 1400);
      }
    }

    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    let confettiTimer = null;
    let confettiPieces = [];

    function resizeCanvas(){
      const card = canvas.parentElement.getBoundingClientRect();
      canvas.width = Math.floor(card.width * devicePixelRatio);
      canvas.height = Math.floor(card.height * devicePixelRatio);
      canvas.style.width = card.width + "px";
      canvas.style.height = card.height + "px";
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }

    function makeConfetti(){
      const rect = canvas.getBoundingClientRect();
      const count = 140;
      confettiPieces = Array.from({length:count}, () => ({
        x: Math.random()*rect.width,
        y: -20 - Math.random()*rect.height*0.6,
        r: 3 + Math.random()*4,
        vx: (-1 + Math.random()*2) * 1.3,
        vy: 2.3 + Math.random()*2.8,
        rot: Math.random()*Math.PI,
        vr: (-1 + Math.random()*2) * 0.07,
        t: Math.random()
      }));
    }

    function drawConfetti(){
      const rect = canvas.getBoundingClientRect();
      ctx.clearRect(0,0,rect.width,rect.height);
      confettiPieces.forEach(p => {
        p.x += p.vx; p.y += p.vy; p.rot += p.vr;
        if (p.y > rect.height + 30) { p.y = -20; p.x = Math.random()*rect.width; }
        if (p.x < -30) p.x = rect.width + 30;
        if (p.x > rect.width + 30) p.x = -30;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        const g = ctx.createLinearGradient(-p.r, -p.r, p.r, p.r);
        g.addColorStop(0, "rgba(255,95,162,.95)");
        g.addColorStop(.5, "rgba(138,92,255,.9)");
        g.addColorStop(1, "rgba(53,214,194,.9)");
        ctx.fillStyle = g;
        ctx.fillRect(-p.r, -p.r, p.r*2.1, p.r*1.3);
        ctx.restore();
      });
    }

    function startConfetti(){
      resizeCanvas();
      makeConfetti();
      if (confettiTimer) return;
      confettiTimer = setInterval(drawConfetti, 16);
      window.addEventListener("resize", resizeCanvas);
    }

    function stopConfetti(){
      if (confettiTimer){
        clearInterval(confettiTimer);
        confettiTimer = null;
        ctx.clearRect(0,0,canvas.width,canvas.height);
      }
      window.removeEventListener("resize", resizeCanvas);
    }

    btnFinal.addEventListener("click", showFinal);
    btnReset.addEventListener("click", resetGame);
    btnReset2.addEventListener("click", () => { closeFinal(); resetGame(); });
    btnClose.addEventListener("click", closeFinal);
    btnCopy.addEventListener("click", copyFinal);

    overlay.addEventListener("click", (e) => { if (e.target === overlay) closeFinal(); });

    btnFinal.disabled = true;
    renderButtons();
    burstHearts(6);
  </script>
</body>
</html>
